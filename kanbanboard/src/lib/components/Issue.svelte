<script> import { format } from 'date-fns'; import { de } from 'date-fns/locale'; export let issue; const isOverdue = new Date(issue.dueDate) < new Date(); function handleDragStart(e) { e.dataTransfer.setData('text/plain', issue.id); } function exportICS() { const start = new Date(issue.dueDate).toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z'; const ics = BEGIN:VCALENDAR VERSION:2.0 BEGIN:VEVENT SUMMARY:${issue.title} DESCRIPTION:${issue.description} DTSTART:${start} DTEND:${start} END:VEVENT END:VCALENDAR; const blob = new Blob([ics], { type: 'text/calendar' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = ${issue.title}.ics; a.click(); } async function shareIssue() { if (navigator.share) { await navigator.share({ title: issue.title, text: ${issue.title}\n${issue.description}\nFÃ¤llig: ${format(new Date(issue.dueDate), 'PPP', { locale: de })} }); } else { alert('Web Share API wird nicht unterstÃ¼tzt.'); } } </script> <div class="bg-white border border-pink-200 rounded-2xl p-4 shadow hover:shadow-lg hover:border-pink-400 transition relative cursor-grab active:cursor-grabbing" draggable="true" role="listitem" on:dragstart={handleDragStart} > <h3 class="text-pink-700 font-bold text-lg flex items-center gap-1 mb-1"> ðŸŒ¸ {issue.title} </h3> <p class="text-gray-700 text-sm mb-2 leading-snug">{issue.description}</p> <p class="text-gray-500 text-xs">ðŸ“… FÃ¤llig: {format(new Date(issue.dueDate), 'PPP', { locale: de })}</p> {#if isOverdue} <span class="absolute top-2 right-2 bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-md font-semibold">ÃœberfÃ¤llig!</span> {/if} <div class="flex justify-end gap-2 mt-3"> <button on:click={exportICS} class="bg-pink-100 hover:bg-pink-200 text-pink-800 text-xs font-semibold px-3 py-1 rounded-lg transition" > ICS </button> <button on:click={shareIssue} class="bg-pink-500 hover:bg-pink-600 text-white text-xs font-semibold px-3 py-1 rounded-lg transition" > Teilen </button> </div> </div>